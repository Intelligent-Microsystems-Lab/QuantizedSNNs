Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
test_bench.py:73: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_train = torch.tensor(train_dataset.train_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
test_bench.py:75: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_test = torch.tensor(test_dataset.test_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
test_bench.py:77: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(train_dataset.train_labels, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
test_bench.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test  = torch.tensor(test_dataset.test_labels, device=device, dtype=dtype)
Training: go
Epoch 1: loss=2.02210e+00, train=5.48893e-01, test=5.44772e-01
Epoch 2: loss=1.59009e+00, train=5.50694e-01, test=5.46474e-01
Epoch 3: loss=1.46145e+00, train=5.94784e-01, test=5.84535e-01
Epoch 4: loss=1.37424e+00, train=6.04856e-01, test=5.97957e-01
Epoch 5: loss=1.30400e+00, train=6.17346e-01, test=6.07572e-01
Epoch 6: loss=1.25121e+00, train=6.34889e-01, test=6.21194e-01
Epoch 7: loss=1.20906e+00, train=6.40858e-01, test=6.29607e-01
Epoch 8: loss=1.16822e+00, train=6.46245e-01, test=6.35717e-01
Epoch 9: loss=1.12971e+00, train=6.49947e-01, test=6.41426e-01
Epoch 10: loss=1.09672e+00, train=6.67439e-01, test=6.55148e-01
Epoch 11: loss=1.06963e+00, train=6.69124e-01, test=6.55849e-01
Epoch 12: loss=1.04353e+00, train=6.76861e-01, test=6.63662e-01
Epoch 13: loss=1.01856e+00, train=6.93036e-01, test=6.81891e-01
Epoch 14: loss=9.94561e-01, train=6.94804e-01, test=6.78686e-01
Epoch 15: loss=9.71679e-01, train=7.00390e-01, test=6.90405e-01
Epoch 16: loss=9.61703e-01, train=7.04626e-01, test=6.90705e-01
Epoch 17: loss=9.44357e-01, train=7.07194e-01, test=6.97616e-01
Epoch 18: loss=9.29302e-01, train=7.15198e-01, test=6.98417e-01
Epoch 19: loss=9.14668e-01, train=7.16265e-01, test=7.03626e-01
Epoch 20: loss=9.02570e-01, train=7.20584e-01, test=7.09034e-01
Epoch 21: loss=8.86055e-01, train=7.25587e-01, test=7.11939e-01
Epoch 22: loss=8.81857e-01, train=7.30673e-01, test=7.20152e-01
Epoch 23: loss=8.61769e-01, train=7.35125e-01, test=7.18450e-01
Epoch 24: loss=8.54724e-01, train=7.34041e-01, test=7.19551e-01
Epoch 25: loss=8.43382e-01, train=7.38327e-01, test=7.25260e-01
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
THCudaCheck FAIL file=/pytorch/aten/src/THC/generic/THCTensorMathPairwise.cu line=196 error=11 : invalid argument
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
test_bench.py:73: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_train = torch.tensor(train_dataset.train_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
test_bench.py:75: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_test = torch.tensor(test_dataset.test_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
test_bench.py:77: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(train_dataset.train_labels, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
test_bench.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test  = torch.tensor(test_dataset.test_labels, device=device, dtype=dtype)
Traceback (most recent call last):
  File "test_bench.py", line 155, in <module>
    weights = get_weights(layers, device=device, time_step=parameters['time_step'], tau_mem=parameters['tau_mem'][0], scale_mult = 7)
  File "/afs/crc.nd.edu/user/c/cschaef6/AdaptExpSNN/snn_training.py", line 62, in get_weights
    torch.nn.init.orthogonal_(w1, gain=weight_scale/np.sqrt(list(layers.values())[i-1]))
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/nn/init.py", line 391, in orthogonal_
    q, r = torch.qr(flattened)
RuntimeError: cuda runtime error (11) : invalid argument at /pytorch/aten/src/THC/generic/THCTensorMathPairwise.cu:196
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
test_bench.py:73: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_train = torch.tensor(train_dataset.train_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
test_bench.py:75: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_test = torch.tensor(test_dataset.test_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
test_bench.py:77: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(train_dataset.train_labels, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
test_bench.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test  = torch.tensor(test_dataset.test_labels, device=device, dtype=dtype)
Training: go
Epoch 1: loss=2.00900e+00, train=5.38320e-01, test=5.31851e-01
Epoch 2: loss=1.61082e+00, train=5.64851e-01, test=5.56991e-01
Epoch 3: loss=1.48606e+00, train=5.88731e-01, test=5.89143e-01
Epoch 4: loss=1.39433e+00, train=6.05239e-01, test=5.96254e-01
Epoch 5: loss=1.32669e+00, train=6.10576e-01, test=5.97155e-01
Epoch 6: loss=1.26580e+00, train=6.25750e-01, test=6.13882e-01
Epoch 7: loss=1.21962e+00, train=6.38841e-01, test=6.25701e-01
Epoch 8: loss=1.17708e+00, train=6.44094e-01, test=6.36619e-01
Epoch 9: loss=1.14023e+00, train=6.64121e-01, test=6.52344e-01
Epoch 10: loss=1.10991e+00, train=6.67139e-01, test=6.58454e-01
Epoch 11: loss=1.08235e+00, train=6.68740e-01, test=6.59555e-01
Epoch 12: loss=1.04915e+00, train=6.79829e-01, test=6.63562e-01
Epoch 13: loss=1.02968e+00, train=6.96071e-01, test=6.79187e-01
Epoch 14: loss=1.00829e+00, train=6.95237e-01, test=6.82292e-01
Epoch 15: loss=9.92657e-01, train=6.95254e-01, test=6.83894e-01
Epoch 16: loss=9.76259e-01, train=6.95604e-01, test=6.84996e-01
Epoch 17: loss=9.55346e-01, train=6.96822e-01, test=6.84996e-01
Epoch 18: loss=9.40947e-01, train=7.12864e-01, test=7.01923e-01
Epoch 19: loss=9.26927e-01, train=7.21785e-01, test=7.12139e-01
Epoch 20: loss=9.11601e-01, train=7.19984e-01, test=7.07332e-01
Epoch 21: loss=8.95474e-01, train=7.24270e-01, test=7.13341e-01
Epoch 22: loss=8.84590e-01, train=7.30206e-01, test=7.14543e-01
Epoch 23: loss=8.72567e-01, train=7.35926e-01, test=7.24359e-01
Epoch 24: loss=8.64760e-01, train=7.35676e-01, test=7.20653e-01
Epoch 25: loss=8.53963e-01, train=7.33158e-01, test=7.22155e-01
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
test_bench.py:73: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_train = torch.tensor(train_dataset.train_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
test_bench.py:75: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_test  = torch.tensor(test_dataset.test_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
test_bench.py:77: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(train_dataset.train_labels, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
test_bench.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test  = torch.tensor(test_dataset.test_labels, device=device, dtype=dtype)
Weight Init
Training: go
Epoch 1: loss=1.33379e+00, train=7.00170e-01, test=6.93873e-01
Epoch 2: loss=9.40138e-01, train=7.45042e-01, test=7.36123e-01
Epoch 3: loss=8.39773e-01, train=7.59181e-01, test=7.50411e-01
Epoch 4: loss=7.74822e-01, train=7.73154e-01, test=7.63569e-01
Epoch 5: loss=7.45052e-01, train=7.76058e-01, test=7.64803e-01
Epoch 6: loss=7.18233e-01, train=7.77744e-01, test=7.67989e-01
Epoch 7: loss=6.99748e-01, train=7.96625e-01, test=7.78063e-01
Epoch 8: loss=6.74915e-01, train=8.02885e-01, test=7.87109e-01
Epoch 9: loss=6.61530e-01, train=8.08226e-01, test=7.96361e-01
Epoch 10: loss=6.51048e-01, train=8.07542e-01, test=7.86493e-01
Epoch 11: loss=6.32143e-01, train=8.05940e-01, test=7.85876e-01
Epoch 12: loss=6.16742e-01, train=8.20312e-01, test=8.03865e-01
Epoch 13: loss=6.22612e-01, train=8.19845e-01, test=7.99753e-01
Epoch 14: loss=6.01610e-01, train=8.25037e-01, test=8.09416e-01
Epoch 15: loss=5.88604e-01, train=8.25254e-01, test=8.04071e-01
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
test_bench.py:73: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_train = torch.tensor(train_dataset.train_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
test_bench.py:75: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  x_test  = torch.tensor(test_dataset.test_data, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
test_bench.py:77: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_train = torch.tensor(train_dataset.train_labels, device=device, dtype=dtype)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
test_bench.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  y_test  = torch.tensor(test_dataset.test_labels, device=device, dtype=dtype)
Weight Init
Training: go
Traceback (most recent call last):
  File "test_bench.py", line 160, in <module>
    loss_hist, train_acc, test_acc, result_w = train_classifier_dropconnect(x_data = x_train, y_data = y_train, x_test = x_test, y_test = y_test, nb_epochs = parameters['nb_epochs'], weights = weights, args_snn = parameters, layers = layers, figures = True, verbose=False, p_drop = parameters['p_drop'],  fig_title=ds_name + " "+ parameters['read_out']+" "+ parameters['neuron_type'].__name__ + ' std: '+str(i*1e-5))
  File "/afs/crc.nd.edu/user/c/cschaef6/AdaptExpSNN/snn_training.py", line 89, in train_classifier_dropconnect
    m = run_snn_dropconnect(x_local.to_dense(), y_local, weights, layers, args_snn, p_drop, False)
  File "/afs/crc.nd.edu/user/c/cschaef6/AdaptExpSNN/snn_training.py", line 53, in run_snn_dropconnect
    _, spk_temp = args['neuron_type'](inputs=inputs, weights=weights[i-1], args = args, layer=i-1, layer_type = width, infer=infer)
TypeError: adex_LIF_neuron() got an unexpected keyword argument 'layer_type'
