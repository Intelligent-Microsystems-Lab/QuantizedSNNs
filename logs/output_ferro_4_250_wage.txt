Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
init done
4333333
Epoch 1: loss=2.28005
Test accuracy: 0.565
Train accuracy: 0.248
Epoch 2: loss=2.22601
Test accuracy: 0.705
Train accuracy: 0.656
Epoch 3: loss=2.17996
Test accuracy: 0.734
Train accuracy: 0.701
Epoch 4: loss=2.14567
Test accuracy: 0.737
Train accuracy: 0.727
Epoch 5: loss=2.12250
Test accuracy: 0.746
Train accuracy: 0.738
Epoch 6: loss=2.10882
Test accuracy: 0.744
Train accuracy: 0.741
Epoch 7: loss=2.10596
Test accuracy: 0.743
Train accuracy: 0.739
Epoch 8: loss=2.10498
Test accuracy: 0.744
Train accuracy: 0.739
Epoch 9: loss=2.10360
Test accuracy: 0.744
Train accuracy: 0.742
Epoch 10: loss=2.10202
Test accuracy: 0.745
Train accuracy: 0.740
Epoch 11: loss=2.10127
Test accuracy: 0.745
Train accuracy: 0.742
Epoch 12: loss=2.10121
Test accuracy: 0.745
Train accuracy: 0.743
Epoch 13: loss=2.10104
Test accuracy: 0.747
Train accuracy: 0.743
Epoch 14: loss=2.10111
Test accuracy: 0.746
Train accuracy: 0.742
Epoch 15: loss=2.10077
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 16: loss=2.10053
Test accuracy: 0.746
Train accuracy: 0.745
Epoch 17: loss=2.10046
Test accuracy: 0.746
Train accuracy: 0.745
Epoch 18: loss=2.10046
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 19: loss=2.10048
Test accuracy: 0.746
Train accuracy: 0.745
Epoch 20: loss=2.10050
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 21: loss=2.10060
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 22: loss=2.10055
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 23: loss=2.10053
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 24: loss=2.10051
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 25: loss=2.10045
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 26: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 27: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 28: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 29: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 30: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 31: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 32: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 33: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 34: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 35: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 36: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 37: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 38: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 39: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 40: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 41: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 42: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 43: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 44: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 45: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 46: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 47: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 48: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 49: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Epoch 50: loss=2.10034
Test accuracy: 0.747
Train accuracy: 0.745
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
init done
4333333
Traceback (most recent call last):
  File "spytorch_dvs_ferro.py", line 413, in <module>
    loss_hist, test_acc, train_acc = train(x_train, y_train, lr = 1e-5, nb_epochs = 80)
  File "spytorch_dvs_ferro.py", line 369, in train
    loss_val.backward()
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/tensor.py", line 118, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/autograd/__init__.py", line 93, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 586.00 MiB (GPU 0; 10.73 GiB total capacity; 7.99 GiB already allocated; 467.56 MiB free; 1.36 GiB cached)
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
init done
4333333
Epoch 1: loss=2.29602
Test accuracy: 0.160
Train accuracy: 0.125
Epoch 2: loss=2.27061
Test accuracy: 0.337
Train accuracy: 0.239
Epoch 3: loss=2.24383
Test accuracy: 0.496
Train accuracy: 0.410
Epoch 4: loss=2.21886
Test accuracy: 0.595
Train accuracy: 0.545
Epoch 5: loss=2.19772
Test accuracy: 0.639
Train accuracy: 0.605
Epoch 6: loss=2.18818
Test accuracy: 0.639
Train accuracy: 0.634
Epoch 7: loss=2.18650
Test accuracy: 0.643
Train accuracy: 0.635
Epoch 8: loss=2.18472
Test accuracy: 0.649
Train accuracy: 0.639
Epoch 9: loss=2.18310
Test accuracy: 0.657
Train accuracy: 0.643
Epoch 10: loss=2.18105
Test accuracy: 0.653
Train accuracy: 0.646
Epoch 11: loss=2.18017
Test accuracy: 0.653
Train accuracy: 0.647
Epoch 12: loss=2.18004
Test accuracy: 0.654
Train accuracy: 0.647
Epoch 13: loss=2.17987
Test accuracy: 0.654
Train accuracy: 0.647
Epoch 14: loss=2.17978
Test accuracy: 0.655
Train accuracy: 0.648
Epoch 15: loss=2.17966
Test accuracy: 0.656
Train accuracy: 0.648
Epoch 16: loss=2.17963
Test accuracy: 0.656
Train accuracy: 0.648
Epoch 17: loss=2.17964
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 18: loss=2.17960
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 19: loss=2.17959
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 20: loss=2.17958
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 21: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 22: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 23: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 24: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 25: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 26: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 27: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 28: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 29: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 30: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 31: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 32: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 33: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 34: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 35: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 36: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 37: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 38: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 39: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 40: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 41: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 42: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 43: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 44: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 45: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 46: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 47: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 48: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 49: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 50: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 51: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 52: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 53: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 54: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 55: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 56: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 57: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 58: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 59: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 60: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 61: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 62: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 63: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 64: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 65: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 66: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 67: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 68: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 69: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 70: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 71: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 72: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 73: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 74: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 75: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 76: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 77: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 78: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 79: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Epoch 80: loss=2.17957
Test accuracy: 0.657
Train accuracy: 0.648
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
init done
4333333
Epoch 1: loss=nan
Test accuracy: 0.086
Train accuracy: 0.080
Traceback (most recent call last):
  File "spytorch_dvs_ferro.py", line 413, in <module>
    loss_hist, test_acc, train_acc = train(x_train, y_train, lr = 1e-5, nb_epochs = 80)
  File "spytorch_dvs_ferro.py", line 369, in train
    loss_val.backward()
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/tensor.py", line 118, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torch/autograd/__init__.py", line 93, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 586.00 MiB (GPU 0; 10.73 GiB total capacity; 8.00 GiB already allocated; 441.56 MiB free; 1.38 GiB cached)
