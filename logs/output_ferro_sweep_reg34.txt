Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
init done
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.49733
Test accuracy: 0.900
Train accuracy: 0.863
Epoch 2: loss=0.42557
Test accuracy: 0.891
Train accuracy: 0.883
Epoch 3: loss=0.31864
Test accuracy: 0.925
Train accuracy: 0.911
Epoch 4: loss=0.22477
Test accuracy: 0.934
Train accuracy: 0.936
Epoch 5: loss=0.17010
Test accuracy: 0.939
Train accuracy: 0.951
Epoch 6: loss=0.13547
Test accuracy: 0.946
Train accuracy: 0.962
Epoch 7: loss=0.11234
Test accuracy: 0.944
Train accuracy: 0.968
Epoch 8: loss=0.09085
Test accuracy: 0.949
Train accuracy: 0.974
Epoch 9: loss=0.08109
Test accuracy: 0.955
Train accuracy: 0.977
Epoch 10: loss=0.04403
Test accuracy: 0.960
Train accuracy: 0.990
Epoch 11: loss=0.03797
Test accuracy: 0.960
Train accuracy: 0.993
Epoch 12: loss=0.03556
Test accuracy: 0.961
Train accuracy: 0.995
Epoch 13: loss=0.03343
Test accuracy: 0.961
Train accuracy: 0.995
Epoch 14: loss=0.03190
Test accuracy: 0.962
Train accuracy: 0.996
Epoch 15: loss=0.03081
Test accuracy: 0.961
Train accuracy: 0.997
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.57027
Test accuracy: 0.889
Train accuracy: 0.851
Epoch 2: loss=0.46104
Test accuracy: 0.892
Train accuracy: 0.873
Epoch 3: loss=0.35304
Test accuracy: 0.915
Train accuracy: 0.902
Epoch 4: loss=0.26025
Test accuracy: 0.930
Train accuracy: 0.929
Epoch 5: loss=0.19534
Test accuracy: 0.938
Train accuracy: 0.945
Epoch 6: loss=0.15776
Test accuracy: 0.936
Train accuracy: 0.954
Epoch 7: loss=0.12970
Test accuracy: 0.947
Train accuracy: 0.962
Epoch 8: loss=0.10382
Test accuracy: 0.954
Train accuracy: 0.970
Epoch 9: loss=0.08220
Test accuracy: 0.951
Train accuracy: 0.977
Epoch 10: loss=0.04676
Test accuracy: 0.959
Train accuracy: 0.990
Epoch 11: loss=0.04176
Test accuracy: 0.961
Train accuracy: 0.992
Epoch 12: loss=0.03922
Test accuracy: 0.961
Train accuracy: 0.993
Epoch 13: loss=0.03745
Test accuracy: 0.961
Train accuracy: 0.994
Epoch 14: loss=0.03640
Test accuracy: 0.962
Train accuracy: 0.995
Epoch 15: loss=0.03493
Test accuracy: 0.962
Train accuracy: 0.995
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.60488
Test accuracy: 0.846
Train accuracy: 0.842
Epoch 2: loss=0.46015
Test accuracy: 0.892
Train accuracy: 0.871
Epoch 3: loss=0.33862
Test accuracy: 0.914
Train accuracy: 0.905
Epoch 4: loss=0.27217
Test accuracy: 0.920
Train accuracy: 0.924
Epoch 5: loss=0.20670
Test accuracy: 0.930
Train accuracy: 0.940
Epoch 6: loss=0.16971
Test accuracy: 0.942
Train accuracy: 0.951
Epoch 7: loss=0.13386
Test accuracy: 0.935
Train accuracy: 0.960
Epoch 8: loss=0.10601
Test accuracy: 0.946
Train accuracy: 0.969
Epoch 9: loss=0.08863
Test accuracy: 0.952
Train accuracy: 0.974
Epoch 10: loss=0.04870
Test accuracy: 0.961
Train accuracy: 0.989
Epoch 11: loss=0.04332
Test accuracy: 0.959
Train accuracy: 0.992
Epoch 12: loss=0.04106
Test accuracy: 0.959
Train accuracy: 0.993
Epoch 13: loss=0.03959
Test accuracy: 0.958
Train accuracy: 0.994
Epoch 14: loss=0.03810
Test accuracy: 0.960
Train accuracy: 0.994
Epoch 15: loss=0.03625
Test accuracy: 0.959
Train accuracy: 0.995
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.51805
Test accuracy: 0.888
Train accuracy: 0.860
Epoch 2: loss=0.44157
Test accuracy: 0.877
Train accuracy: 0.878
Epoch 3: loss=0.32311
Test accuracy: 0.921
Train accuracy: 0.910
Epoch 4: loss=0.23396
Test accuracy: 0.925
Train accuracy: 0.934
Epoch 5: loss=0.18856
Test accuracy: 0.928
Train accuracy: 0.946
Epoch 6: loss=0.15016
Test accuracy: 0.937
Train accuracy: 0.956
Epoch 7: loss=0.11940
Test accuracy: 0.949
Train accuracy: 0.965
Epoch 8: loss=0.09417
Test accuracy: 0.943
Train accuracy: 0.973
Epoch 9: loss=0.08084
Test accuracy: 0.958
Train accuracy: 0.976
Epoch 10: loss=0.04327
Test accuracy: 0.960
Train accuracy: 0.991
Epoch 11: loss=0.03762
Test accuracy: 0.961
Train accuracy: 0.993
Epoch 12: loss=0.03531
Test accuracy: 0.961
Train accuracy: 0.995
Epoch 13: loss=0.03340
Test accuracy: 0.963
Train accuracy: 0.995
Epoch 14: loss=0.03207
Test accuracy: 0.961
Train accuracy: 0.996
Epoch 15: loss=0.03104
Test accuracy: 0.960
Train accuracy: 0.996
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.57145
Test accuracy: 0.900
Train accuracy: 0.852
Epoch 2: loss=0.44768
Test accuracy: 0.890
Train accuracy: 0.877
Epoch 3: loss=0.33825
Test accuracy: 0.913
Train accuracy: 0.907
Epoch 4: loss=0.29680
Test accuracy: 0.915
Train accuracy: 0.919
Epoch 5: loss=0.24305
Test accuracy: 0.929
Train accuracy: 0.932
Epoch 6: loss=0.19026
Test accuracy: 0.932
Train accuracy: 0.946
Epoch 7: loss=0.14862
Test accuracy: 0.940
Train accuracy: 0.957
Epoch 8: loss=0.12079
Test accuracy: 0.948
Train accuracy: 0.964
Epoch 9: loss=0.09736
Test accuracy: 0.947
Train accuracy: 0.972
Epoch 10: loss=0.05608
Test accuracy: 0.958
Train accuracy: 0.987
Epoch 11: loss=0.04934
Test accuracy: 0.958
Train accuracy: 0.990
Epoch 12: loss=0.04713
Test accuracy: 0.960
Train accuracy: 0.991
Epoch 13: loss=0.04549
Test accuracy: 0.960
Train accuracy: 0.992
Epoch 14: loss=0.04395
Test accuracy: 0.958
Train accuracy: 0.993
Epoch 15: loss=0.04319
Test accuracy: 0.959
Train accuracy: 0.993
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.58127
Test accuracy: 0.870
Train accuracy: 0.854
Epoch 2: loss=0.45803
Test accuracy: 0.898
Train accuracy: 0.874
Epoch 3: loss=0.29844
Test accuracy: 0.922
Train accuracy: 0.917
Epoch 4: loss=0.22516
Test accuracy: 0.932
Train accuracy: 0.936
Epoch 5: loss=0.18218
Test accuracy: 0.938
Train accuracy: 0.948
Epoch 6: loss=0.13915
Test accuracy: 0.946
Train accuracy: 0.960
Epoch 7: loss=0.11384
Test accuracy: 0.943
Train accuracy: 0.967
Epoch 8: loss=0.09157
Test accuracy: 0.946
Train accuracy: 0.974
Epoch 9: loss=0.08484
Test accuracy: 0.952
Train accuracy: 0.976
Epoch 10: loss=0.04314
Test accuracy: 0.961
Train accuracy: 0.991
Epoch 11: loss=0.03763
Test accuracy: 0.960
Train accuracy: 0.994
Epoch 12: loss=0.03526
Test accuracy: 0.960
Train accuracy: 0.995
Epoch 13: loss=0.03367
Test accuracy: 0.962
Train accuracy: 0.996
Epoch 14: loss=0.03267
Test accuracy: 0.961
Train accuracy: 0.996
Epoch 15: loss=0.03167
Test accuracy: 0.961
Train accuracy: 0.996
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.68106
Test accuracy: 0.866
Train accuracy: 0.854
Epoch 2: loss=0.48988
Test accuracy: 0.894
Train accuracy: 0.865
Epoch 3: loss=0.33469
Test accuracy: 0.919
Train accuracy: 0.907
Epoch 4: loss=0.26772
Test accuracy: 0.924
Train accuracy: 0.923
Epoch 5: loss=0.24183
Test accuracy: 0.922
Train accuracy: 0.931
Epoch 6: loss=0.20048
Test accuracy: 0.919
Train accuracy: 0.943
Epoch 7: loss=0.17537
Test accuracy: 0.936
Train accuracy: 0.949
Epoch 8: loss=0.14031
Test accuracy: 0.937
Train accuracy: 0.960
Epoch 9: loss=0.11247
Test accuracy: 0.948
Train accuracy: 0.969
Epoch 10: loss=0.06626
Test accuracy: 0.954
Train accuracy: 0.984
Epoch 11: loss=0.06210
Test accuracy: 0.953
Train accuracy: 0.986/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
No handles with labels found to put in legend.

Epoch 12: loss=0.06072
Test accuracy: 0.952
Train accuracy: 0.987
Epoch 13: loss=0.05994
Test accuracy: 0.953
Train accuracy: 0.988
Epoch 14: loss=0.05906
Test accuracy: 0.953
Train accuracy: 0.988
Epoch 15: loss=0.05823
Test accuracy: 0.953
Train accuracy: 0.988
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=0.96981
Test accuracy: 0.894
Train accuracy: 0.849
Epoch 2: loss=0.43001
Test accuracy: 0.872
Train accuracy: 0.882
Epoch 3: loss=0.38841
Test accuracy: 0.914
Train accuracy: 0.896
Epoch 4: loss=0.28522
Test accuracy: 0.923
Train accuracy: 0.922
Epoch 5: loss=0.22375
Test accuracy: 0.922
Train accuracy: 0.939
Epoch 6: loss=0.18996
Test accuracy: 0.930
Train accuracy: 0.948
Epoch 7: loss=0.16150
Test accuracy: 0.935
Train accuracy: 0.957
Epoch 8: loss=0.14321
Test accuracy: 0.944
Train accuracy: 0.963
Epoch 9: loss=0.13137
Test accuracy: 0.945
Train accuracy: 0.966
Epoch 10: loss=0.07754
Test accuracy: 0.952
Train accuracy: 0.982
Epoch 11: loss=0.07288
Test accuracy: 0.953
Train accuracy: 0.984
Epoch 12: loss=0.07060
Test accuracy: 0.953
Train accuracy: 0.985
Epoch 13: loss=0.06887
Test accuracy: 0.954
Train accuracy: 0.985
Epoch 14: loss=0.06745
Test accuracy: 0.953
Train accuracy: 0.986
Epoch 15: loss=0.06684
Test accuracy: 0.952
Train accuracy: 0.986
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=1.84663
Test accuracy: 0.894
Train accuracy: 0.830
Epoch 2: loss=0.41113
Test accuracy: 0.888
Train accuracy: 0.895
Epoch 3: loss=0.37087
Test accuracy: 0.900
Train accuracy: 0.906
Epoch 4: loss=0.34981
Test accuracy: 0.902
Train accuracy: 0.913
Epoch 5: loss=0.31065
Test accuracy: 0.918
Train accuracy: 0.924
Epoch 6: loss=0.28015
Test accuracy: 0.917
Train accuracy: 0.933
Epoch 7: loss=0.24740
Test accuracy: 0.929
Train accuracy: 0.942
Epoch 8: loss=0.23171
Test accuracy: 0.924
Train accuracy: 0.946
Epoch 9: loss=0.21145
Test accuracy: 0.926
Train accuracy: 0.952
Epoch 10: loss=0.12898
Test accuracy: 0.941
Train accuracy: 0.967
Epoch 11: loss=0.12333
Test accuracy: 0.939
Train accuracy: 0.969
Epoch 12: loss=0.12111
Test accuracy: 0.939
Train accuracy: 0.970
Epoch 13: loss=0.11938
Test accuracy: 0.938
Train accuracy: 0.970
Epoch 14: loss=0.11764
Test accuracy: 0.939
Train accuracy: 0.971
Epoch 15: loss=0.11697
Test accuracy: 0.941
Train accuracy: 0.971
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=4.22246
Test accuracy: 0.873
Train accuracy: 0.796
Epoch 2: loss=0.58619
Test accuracy: 0.893
Train accuracy: 0.882
Epoch 3: loss=0.52199
Test accuracy: 0.894
Train accuracy: 0.898
Epoch 4: loss=0.48877
Test accuracy: 0.900
Train accuracy: 0.908
Epoch 5: loss=0.45708
Test accuracy: 0.906
Train accuracy: 0.916
Epoch 6: loss=0.43468
Test accuracy: 0.919
Train accuracy: 0.923
Epoch 7: loss=0.41836
Test accuracy: 0.918
Train accuracy: 0.929
Epoch 8: loss=0.40051
Test accuracy: 0.921
Train accuracy: 0.933
Epoch 9: loss=0.38907
Test accuracy: 0.924
Train accuracy: 0.936
Epoch 10: loss=0.20160
Test accuracy: 0.929
Train accuracy: 0.949
Epoch 11: loss=0.19391
Test accuracy: 0.928
Train accuracy: 0.950
Epoch 12: loss=0.19077
Test accuracy: 0.930
Train accuracy: 0.951
Epoch 13: loss=0.18825
Test accuracy: 0.930
Train accuracy: 0.951
Epoch 14: loss=0.18684
Test accuracy: 0.930
Train accuracy: 0.951
Epoch 15: loss=0.18576
Test accuracy: 0.931
Train accuracy: 0.952
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=12.41515
Test accuracy: 0.851
Train accuracy: 0.730
Epoch 2: loss=1.07704
Test accuracy: 0.883
Train accuracy: 0.858
Epoch 3: loss=1.00709
Test accuracy: 0.886
Train accuracy: 0.880
Epoch 4: loss=0.97255
Test accuracy: 0.902
Train accuracy: 0.890
Epoch 5: loss=0.92240
Test accuracy: 0.905
Train accuracy: 0.901
Epoch 6: loss=0.91833
Test accuracy: 0.905
Train accuracy: 0.905
Epoch 7: loss=0.88848
Test accuracy: 0.886
Train accuracy: 0.913
Epoch 8: loss=0.88016
Test accuracy: 0.916
Train accuracy: 0.915
Epoch 9: loss=0.86879
Test accuracy: 0.917
Train accuracy: 0.921
Epoch 10: loss=0.30885
Test accuracy: 0.923
Train accuracy: 0.934
Epoch 11: loss=0.28947
Test accuracy: 0.922
Train accuracy: 0.934
Epoch 12: loss=0.28718
Test accuracy: 0.922
Train accuracy: 0.934
Epoch 13: loss=0.28553
Test accuracy: 0.922
Train accuracy: 0.934
Epoch 14: loss=0.28475
Test accuracy: 0.923
Train accuracy: 0.935
Epoch 15: loss=0.28451
Test accuracy: 0.922
Train accuracy: 0.936
{'quantization.global_wb': 34, 'inp_mult': 80, 'nb_hidden': 800, 'nb_steps': 150, 'batch_size': 128, 'quantization.global_lr': 0.0004, 'reg_size': 0.001, 'mult_eq': 0.12, 'class_method': 'integrate', 'weight_sum': [2.1, 0.003]}
Epoch 1: loss=40.19917
Test accuracy: 0.816
Train accuracy: 0.650
Epoch 2: loss=2.65332
Test accuracy: 0.860
Train accuracy: 0.838
Epoch 3: loss=2.54019
Test accuracy: 0.884
Train accuracy: 0.864
Epoch 4: loss=2.50376
Test accuracy: 0.894
Train accuracy: 0.881
Epoch 5: loss=2.38630
Test accuracy: 0.896
Train accuracy: 0.892
Epoch 6: loss=2.41892
Test accuracy: 0.899
Train accuracy: 0.899
Epoch 7: loss=2.36596
Test accuracy: 0.909
Train accuracy: 0.904
Epoch 8: loss=2.37524
Test accuracy: 0.900
Train accuracy: 0.910
Epoch 9: loss=2.36333
Test accuracy: 0.906
Train accuracy: 0.912
Epoch 10: loss=0.51519
Test accuracy: 0.918
Train accuracy: 0.926
Epoch 11: loss=0.45081
Test accuracy: 0.919
Train accuracy: 0.926
Epoch 12: loss=0.44826
Test accuracy: 0.920
Train accuracy: 0.927
Epoch 13: loss=0.44810
Test accuracy: 0.919
Train accuracy: 0.928
Epoch 14: loss=0.44992
Test accuracy: 0.918
Train accuracy: 0.928
Epoch 15: loss=0.45579
Test accuracy: 0.919
Train accuracy: 0.927
