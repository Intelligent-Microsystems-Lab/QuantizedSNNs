Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
init done
{'quantization.global_wb': 6, 'inp_mult': 194.51274827715784, 'nb_hidden': 1291, 'nb_steps': 80, 'batch_size': 469, 'quantization.global_lr': 0.000609263835526897, 'reg_size': 0.0010562188078442382, 'mult_eq': 0.14799450709214998, 'class_method': 'integrate'}
Epoch 1: loss=1.74043
Test accuracy: 0.910
Train accuracy: 0.743
Epoch 2: loss=0.66572
Test accuracy: 0.927
Train accuracy: 0.917
Epoch 3: loss=0.44916
Test accuracy: 0.933
Train accuracy: 0.932
Epoch 4: loss=0.34580
Test accuracy: 0.938
Train accuracy: 0.941
Epoch 5: loss=0.30010
Test accuracy: 0.939
Train accuracy: 0.943
Epoch 6: loss=0.27394
Test accuracy: 0.935
Train accuracy: 0.947
Epoch 7: loss=0.26038
Test accuracy: 0.937
Train accuracy: 0.947
Epoch 8: loss=0.25353
Test accuracy: 0.937
Train accuracy: 0.949
Epoch 9: loss=0.24352
Test accuracy: 0.945
Train accuracy: 0.952
Epoch 10: loss=0.18979
Test accuracy: 0.952
Train accuracy: 0.969
Epoch 11: loss=0.16431
Test accuracy: 0.953
Train accuracy: 0.977
Epoch 12: loss=0.15176
Test accuracy: 0.954
Train accuracy: 0.981
Epoch 13: loss=0.14336
Test accuracy: 0.953
Train accuracy: 0.983
Epoch 14: loss=0.13610
Test accuracy: 0.953
Train accuracy: 0.985
Epoch 15: loss=0.13179
Test accuracy: 0.953
Train accuracy: 0.985
Epoch 16: loss=0.12704
Test accuracy: 0.952
Train accuracy: 0.986
Epoch 17: loss=0.12388
Test accuracy: 0.952
Train accuracy: 0.986
Epoch 18: loss=0.11963
Test accuracy: 0.952
Train accuracy: 0.988
Epoch 19: loss=0.11091
Test accuracy: 0.952
Train accuracy: 0.991
Epoch 20: loss=0.10893
Test accuracy: 0.952
Train accuracy: 0.992
Epoch 21: loss=0.10783
Test accuracy: 0.952
Train accuracy: 0.992
Epoch 22: loss=0.10704
Test accuracy: 0.952
Train accuracy: 0.993
Epoch 23: loss=0.10592
Test accuracy: 0.951
Train accuracy: 0.993
Epoch 24: loss=0.10523
Test accuracy: 0.951
Train accuracy: 0.993
Epoch 25: loss=0.10477
Test accuracy: 0.952
Train accuracy: 0.993
Epoch 26: loss=0.10403
Test accuracy: 0.951
Train accuracy: 0.993
Epoch 27: loss=0.10368
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 28: loss=0.10267
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 29: loss=0.10255
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 30: loss=0.10239
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 31: loss=0.10227
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 32: loss=0.10233
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 33: loss=0.10246
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 34: loss=0.10217
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 35: loss=0.10233
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 36: loss=0.10218
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 37: loss=0.10212
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 38: loss=0.10198
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 39: loss=0.10212
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 40: loss=0.10202
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 41: loss=0.10205
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 42: loss=0.10207
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 43: loss=0.10205
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 44: loss=0.10202
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 45: loss=0.10191
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 46: loss=0.10189
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 47: loss=0.10196
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 48: loss=0.10190
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 49: loss=0.10194
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 50: loss=0.10171
Test accuracy: 0.951
Train accuracy: 0.994
Traceback (most recent call last):
  File "spytorch_mnist_lif.py", line 494, in <module>
    para_dict = {'quantization.global_wb':quantization.global_wb, 'inp_mult':inp_mult, 'reg_size':reg1, 'weight_sum': sum1v }
NameError: name 'sum1v' is not defined
Loading python/3.7.3
  Loading requirement: tcl/8.6.8 gcc/8.3.0
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:53: UserWarning: train_data has been renamed data
  warnings.warn("train_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:58: UserWarning: test_data has been renamed data
  warnings.warn("test_data has been renamed data")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:43: UserWarning: train_labels has been renamed targets
  warnings.warn("train_labels has been renamed targets")
/afs/crc.nd.edu/user/c/cschaef6/.local/lib/python3.7/site-packages/torchvision/datasets/mnist.py:48: UserWarning: test_labels has been renamed targets
  warnings.warn("test_labels has been renamed targets")
init done
{'quantization.global_wb': 6, 'inp_mult': 194.51274827715784, 'nb_hidden': 1291, 'nb_steps': 80, 'batch_size': 469, 'quantization.global_lr': 0.000609263835526897, 'reg_size': 0.0010562188078442382, 'mult_eq': 0.14799450709214998, 'class_method': 'integrate'}
Epoch 1: loss=1.78667
Test accuracy: 0.903
Train accuracy: 0.739
Epoch 2: loss=0.70081
Test accuracy: 0.926
Train accuracy: 0.914
Epoch 3: loss=0.46831
Test accuracy: 0.936
Train accuracy: 0.930
Epoch 4: loss=0.35950
Test accuracy: 0.936
Train accuracy: 0.939
Epoch 5: loss=0.30191
Test accuracy: 0.939
Train accuracy: 0.945
Epoch 6: loss=0.27391
Test accuracy: 0.939
Train accuracy: 0.947
Epoch 7: loss=0.25842
Test accuracy: 0.940
Train accuracy: 0.949
Epoch 8: loss=0.25399
Test accuracy: 0.937
Train accuracy: 0.950
Epoch 9: loss=0.24411
Test accuracy: 0.937
Train accuracy: 0.952
Epoch 10: loss=0.19177
Test accuracy: 0.950
Train accuracy: 0.969
Epoch 11: loss=0.16414
Test accuracy: 0.951
Train accuracy: 0.977
Epoch 12: loss=0.15146
Test accuracy: 0.953
Train accuracy: 0.981
Epoch 13: loss=0.14301
Test accuracy: 0.952
Train accuracy: 0.983
Epoch 14: loss=0.13689
Test accuracy: 0.953
Train accuracy: 0.984
Epoch 15: loss=0.13148
Test accuracy: 0.953
Train accuracy: 0.985
Epoch 16: loss=0.12681
Test accuracy: 0.952
Train accuracy: 0.987
Epoch 17: loss=0.12249
Test accuracy: 0.952
Train accuracy: 0.987
Epoch 18: loss=0.11828
Test accuracy: 0.950
Train accuracy: 0.989
Epoch 19: loss=0.11048
Test accuracy: 0.950
Train accuracy: 0.991
Epoch 20: loss=0.10820
Test accuracy: 0.951
Train accuracy: 0.992
Epoch 21: loss=0.10667
Test accuracy: 0.951
Train accuracy: 0.993
Epoch 22: loss=0.10555
Test accuracy: 0.951
Train accuracy: 0.993
Epoch 23: loss=0.10501
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 24: loss=0.10419
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 25: loss=0.10357
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 26: loss=0.10300
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 27: loss=0.10272
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 28: loss=0.10139
Test accuracy: 0.952
Train accuracy: 0.994
Epoch 29: loss=0.10116
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 30: loss=0.10120
Test accuracy: 0.950
Train accuracy: 0.995
Epoch 31: loss=0.10124
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 32: loss=0.10121
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 33: loss=0.10115
Test accuracy: 0.951
Train accuracy: 0.994
Epoch 34: loss=0.10102
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 35: loss=0.10114
Test accuracy: 0.952
Train accuracy: 0.995
Epoch 36: loss=0.10111
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 37: loss=0.10101
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 38: loss=0.10110
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 39: loss=0.10096
Test accuracy: 0.952
Train accuracy: 0.995
Epoch 40: loss=0.10083
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 41: loss=0.10086
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 42: loss=0.10097
Test accuracy: 0.952
Train accuracy: 0.995
Epoch 43: loss=0.10103
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 44: loss=0.10090
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 45: loss=0.10089
Test accuracy: 0.950
Train accuracy: 0.995
Epoch 46: loss=0.10085
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 47: loss=0.10087
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 48: loss=0.10084
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 49: loss=0.10087
Test accuracy: 0.951
Train accuracy: 0.995
Epoch 50: loss=0.10076
Test accuracy: 0.951
Train accuracy: 0.995
{'quantization.global_wb': 6, 'inp_mult': 194.51274827715784, 'reg_size': 0.0010562188078442382}
